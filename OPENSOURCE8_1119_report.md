# 시스템 설계서     
Elasticsearch

Elasticsearch는 Apache Lucene(아파치 루씬) 기반의 분산 검색 엔진이다. Elasticsearch를 통해 Java에서 개발한 정보 검색용 라이브러리인 루씬 라이브러리를 단독으로 사용할 수 있으며, 방대한 양의 데이터를 신속하게 저장, 검색, 분석을 수행할 수 있다. Elasticsearch는 아파치 라이선스 조항에 의거하여 오픈소스로 출시되어 있다. 공식 클라이언트들은 자바(Java), C#닷넷(.NET), PHP, 파이썬(Python), 그루비(Groovy) 등 수많은 언어로 이용이 가능하다.

Elasticsearch는 여러 문서에서 특정 문자열을 검색하는 분산처리를 통해 실시간성으로 빠른 검색이 가능하다. 특히 기존의 데이터로 처리하기 힘든 대량의 텍스트와 음성과 같은 정해진 규칙이 없는 비정형 데이터 검색이 가능하며 전문 검색(full text) 검색과 구조 검색 모두를 지원한다. 또한 기본적으로는 검색엔진이지만 MongoDB나 Hbase와 같은 대용량 스토리지로도 활용이 가능하다는 특징을 가진다.

Elasticsearch의 동작 과정은 첫째, 로그, 시스템, 메트릭, 웹 애플리케이션 등 다양한 소스로부터 원시 데이터가 Elasticsearch로 흘러들어간다. 둘째, Elasticsearch는 이를 검색 시간을 단축할 수 있는 Inverted Index(역 인덱스) 구조를 만들어 수집된 정보를 색인(indexing) 한다. 여기서 역색인이란 일반적인 색인의 목적은 ‘문서의 위치’에 대한 index를 만들어서 빠르게 그 문서에 접근하고자 하는 것인데, 역색인은 반대로 ‘문서 내의 문자와 같은 내용물’의 매핑 정보를 색인 해놓는 것이다. 따라서 역색인 구조를 통해서 특정 단어를 찾을 때 문서 전체에서 찾는 것이 아닌, 단어가 포함된 특정 문서의 위치를 알아내어 빠르게 결과를 찾아낼 수 있다. 마지막으로 사용자의 질의를 JSON형식으로 입력받아 색인기에서 저장한 역색인 구조에서 일치하는 문서를 찾아 JSON 형식으로 결과로 반환한다.

Elasticsearch는 현재 웹 문서 검색, 소셜 데이터 분석, 쇼핑몰 검색 등에 활용되고 있으며, 빅데이터 분석/처리 및 MSA 환경의 로그 모니터링 등에도 활용되고 있다. 삼성 SDS는 Elasticsearch 기반으로 Chatbot Birty를 구축, 무료 여행 가이드 어플리케이션 Triple에서는 Elastic Cloud를 메인 플랫폼으로 사용하는 등 여러 분야에서 Elasticsearch를 사용하고 있다.

keyBERT

자연어 처리를 위해 구글에서 고안한 트랜스포머 기반의 머신러닝 기법인 BERT를 적용한 오픈 소스 파이썬 모듈이다. keyBERT는 원본 문서를 가장 잘 나타내는 중요한 용어 또는 구문을 찾아내는 키워드 추출 작업을 한다.

keyBERT의 원리는 BERT를 이용해 문서 레벨 (document-level)에서의 주제 (representation)를 파악하도록 하고, N-gram을 위해 단어(자연어)를 기계가 이해할 수 있는 숫자의 나열인 벡터로 바꾸는 임베딩 작업을 한다. 여기서 N-gram 이란 Bag of Words, TF-IDF(Term Frequency - Inverse Document Frequency) 와 같이 사용되는 횟수 기반의 벡터 표현 방식을 사용하는 언어 모델이다. 이후 N-gram 모델을 사용해 문서의 각 문장을 단어로 쪼개준다. 코사인 유사도를 계산하여 어떤 N-gram 단어 또는 구가 문서와 가장 유사한지 찾아낸다. 그리고 가장 유사한 단어들은 문서를 가장 잘 설명할 수 있는 키워드로 분류된다.

![Image.png](https://res.craft.do/user/full/8ce8fb2c-58d3-136f-9cce-c7e23418d06c/doc/D78E9B0C-210A-4811-A026-DD5CC75719F3/6D3BA952-3438-4E19-B67B-0ED1532543C1_2/8uhAxBjLyfwy39zEQ0ELgArO2LMlGRWE1Hyh5mjafWMz/Image.png)

또한, keyBERT는 중복된 의미의 키워드가 너무 많이 추출되는 경우에 대비해 결과 키워드에 다양성을 도입하는 MSS, MMR 두 가지 방법을 포함한다. MSS는 candidate-document 간 거리는 최소로 하면서 candidate-candidate 간 거리는 최대로 함으로써 의미적으로 풍부한 키워드 set을 얻는다. 문서와 가장 유사한 words/phrases 2개를 사용해 이 두 개의 top_n 단어에서 모든 top_n combination을 취해 코사인 유사도를 구한다. 여기서 유사도가 가장 낮은 조합을 추출하는 방법론이다. MMR은 텍스트 요약 작업에서 중복성을 최소화하고 결과의 다양성을 극대화하기 위해 노력한다. 문서와 가장 유사한 키워드를 선택하는 것으로 시작한다. 그런 다음 문서와 비슷하면서도 이미 선택한 키워드와 비슷하지 않은 새 후보를 반복적으로 선택한다.

이처럼 keyBERT는 비교적 단순함에도 불구하고 효율적이기 때문에 키워드 추출을 수행하는 경우 유용하게 사용된다.

